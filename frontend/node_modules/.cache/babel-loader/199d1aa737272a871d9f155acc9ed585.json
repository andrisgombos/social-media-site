{"ast":null,"code":"export const signInAction = (credentials, history) => {\n  return (dispatch, getState) => {\n    const url = \"https://motion.propulsion-home.ch/backend/api/auth/token/\";\n    const config = {\n      method: \"POST\",\n      body: JSON.stringify(credentials),\n      headers: new Headers({\n        \"Content-Type\": \"application/json\"\n      })\n    };\n    fetch(url, config).then(res => {\n      return res.json();\n    }).then(data => {\n      if (data.access || localStorage.getItem('token')) {\n        const user = {\n          token: data.access,\n          userInfo: data.user\n        };\n        const action = {\n          type: \"USER_SIGNIN\",\n          payload: user\n        };\n        dispatch(action);\n        if (data.access) localStorage.setItem(\"token\", data.access);\n        localStorage.setItem(\"user\", data.user.first_name);\n        history.push('/');\n      } else {\n        alert('Ooops, try again!');\n      }\n    });\n  };\n};","map":{"version":3,"sources":["C:/Users/andri/PycharmProjects/12eyes/12eyes_second_try/frontend/src/components/store/actions/signInAction.js"],"names":["signInAction","credentials","history","dispatch","getState","url","config","method","body","JSON","stringify","headers","Headers","fetch","then","res","json","data","access","localStorage","getItem","user","token","userInfo","action","type","payload","setItem","first_name","push","alert"],"mappings":"AAAA,OAAO,MAAMA,YAAY,GAAG,CAACC,WAAD,EAAcC,OAAd,KAA0B;AAClD,SAAO,CAACC,QAAD,EAAWC,QAAX,KAAwB;AAC3B,UAAMC,GAAG,GAAG,2DAAZ;AACJ,UAAMC,MAAM,GAAG;AACbC,MAAAA,MAAM,EAAE,MADK;AAEbC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeT,WAAf,CAFO;AAGbU,MAAAA,OAAO,EAAE,IAAIC,OAAJ,CAAY;AACnB,wBAAgB;AADG,OAAZ;AAHI,KAAf;AAOAC,IAAAA,KAAK,CAACR,GAAD,EAAMC,MAAN,CAAL,CACGQ,IADH,CACSC,GAAD,IAAS;AACb,aAAOA,GAAG,CAACC,IAAJ,EAAP;AACD,KAHH,EAIGF,IAJH,CAISG,IAAD,IAAU;AACZ,UAAGA,IAAI,CAACC,MAAL,IAAeC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAlB,EAAgD;AAClD,cAAMC,IAAI,GAAG;AACXC,UAAAA,KAAK,EAAEL,IAAI,CAACC,MADD;AAEXK,UAAAA,QAAQ,EAAEN,IAAI,CAACI;AAFJ,SAAb;AAIA,cAAMG,MAAM,GAAG;AACbC,UAAAA,IAAI,EAAE,aADO;AAEbC,UAAAA,OAAO,EAAEL;AAFI,SAAf;AAIAlB,QAAAA,QAAQ,CAACqB,MAAD,CAAR;AACA,YAAGP,IAAI,CAACC,MAAR,EAAeC,YAAY,CAACQ,OAAb,CAAqB,OAArB,EAA8BV,IAAI,CAACC,MAAnC;AACfC,QAAAA,YAAY,CAACQ,OAAb,CAAqB,MAArB,EAA6BV,IAAI,CAACI,IAAL,CAAUO,UAAvC;AACA1B,QAAAA,OAAO,CAAC2B,IAAR,CAAa,GAAb;AACC,OAbC,MAaI;AACFC,QAAAA,KAAK,CAAC,mBAAD,CAAL;AACH;AACF,KArBH;AAsBC,GA/BD;AAgCH,CAjCM","sourcesContent":["export const signInAction = (credentials, history) => {\r\n    return (dispatch, getState) => {\r\n        const url = \"https://motion.propulsion-home.ch/backend/api/auth/token/\";\r\n    const config = {\r\n      method: \"POST\",\r\n      body: JSON.stringify(credentials),\r\n      headers: new Headers({\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n    };\r\n    fetch(url, config)\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n          if(data.access || localStorage.getItem('token')){\r\n        const user = {\r\n          token: data.access,\r\n          userInfo: data.user\r\n        }    \r\n        const action = {\r\n          type: \"USER_SIGNIN\",\r\n          payload: user,\r\n        };\r\n        dispatch(action);\r\n        if(data.access)localStorage.setItem(\"token\", data.access);\r\n        localStorage.setItem(\"user\", data.user.first_name);\r\n        history.push('/')\r\n        }else {\r\n            alert('Ooops, try again!')\r\n        }\r\n      });\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}